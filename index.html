<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KonMari Method</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #fafaf9, #f5f5f4);
            min-height: 100vh;
            padding: 20px;
            color: #44403c;
        }
        
        .container { max-width: 800px; margin: 0 auto; }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 3rem;
            font-weight: 300;
            margin-bottom: 5px;
        }
        
        .version {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            background: white;
            border-radius: 50px;
            height: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #fda4af, #fb7185);
            height: 100%;
            width: 0%;
            transition: width 0.5s;
        }
        
        .quote {
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
            font-style: italic;
            font-size: 1.1rem;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .mode-toggle {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid #e5e5e5;
        }
        
        .toggle-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .toggle-btn.active {
            background: #ef4444;
            color: white;
        }
        
        .category {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid #e5e5e5;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .category:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .category.completed {
            background: #f0fdf4;
            border-color: #bbf7d0;
        }
        
        .category.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: #fecaca;
            color: #dc2626;
        }
        
        .category.completed .category-icon {
            background: #bbf7d0;
            color: #166534;
        }
        
        .category-info h3 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .category-info p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .detail {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .joy-box {
            background: #fef2f2;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .joy-question {
            font-size: 1.2rem;
            font-style: italic;
            color: #991b1b;
            margin: 15px 0;
        }
        
        .photo-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .photo-upload {
            display: inline-block;
            background: #e9ecef;
            border: 2px dashed #adb5bd;
            border-radius: 8px;
            padding: 20px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
        }
        
        .photo-upload:hover {
            background: #dee2e6;
            border-color: #6c757d;
        }
        
        .photo-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
            margin: 10px;
        }
        
        .screenshot-prompt {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #7c2d12;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .tips {
            margin: 20px 0;
        }
        
        .tip {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .tip-bullet {
            width: 8px;
            height: 8px;
            background: #fb7185;
            border-radius: 50%;
            margin-top: 8px;
            flex-shrink: 0;
        }
        
        .process {
            background: #fafaf9;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .process-step {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .step-number {
            width: 25px;
            height: 25px;
            background: #e5e5e5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .btn-secondary {
            background: #e5e5e5;
            color: #333;
        }
        
        .btn-primary {
            background: #ef4444;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-1px);
        }
        
        .reward-section {
            position: relative;
            margin: 20px 0;
        }
        
        .reward-quote {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            font-style: italic;
            font-size: 1.1rem;
        }
        
        .big-complete-button {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            transition: all 0.5s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .big-complete-button:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.4);
        }
        
        .big-complete-button.dissolve {
            opacity: 0;
            transform: scale(0.8);
            pointer-events: none;
        }
        
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>KonMari Method</h1>
            <p class="version">by Dino Bronzi, ver. 3.1</p>
            <p>La magia del riordino che cambia la vita</p>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
            <p id="progressText">0/5 categorie completate</p>
        </div>

        <div class="quote" id="quote">
            <p id="quoteText"></p>
            <p>‚Äî Marie Kondo</p>
            <button class="close-btn" onclick="hideQuote()">‚úï</button>
        </div>

        <div class="mode-toggle">
            <h3>Modalit√† di riordino:</h3>
            <button class="toggle-btn active" id="rigidBtn" onclick="setMode('rigid')">üéØ Rigida (KonMari)</button>
            <button class="toggle-btn" id="freeBtn" onclick="setMode('free')">üÜì Libera</button>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                <span id="modeDesc">Segui l'ordine originale di Marie Kondo</span>
            </p>
        </div>

        <div id="categoryList">
            <h2 style="text-align: center; margin-bottom: 30px;">Scegli una categoria per iniziare</h2>
            <p id="warningText" style="text-align: center; color: #666; margin-bottom: 30px;"></p>
            
            <div class="category" onclick="showCategory(0)" id="cat0">
                <div class="category-icon" id="icon0">üëï</div>
                <div class="category-info">
                    <h3>1. Vestiti</h3>
                    <p>Raccogli TUTTI i vestiti da ogni stanza e mettili in un posto</p>
                </div>
            </div>

            <div class="category" onclick="showCategory(1)" id="cat1">
                <div class="category-icon" id="icon1">üìö</div>
                <div class="category-info">
                    <h3>2. Libri</h3>
                    <p>Raduna tutti i libri, riviste, manuali dalla casa</p>
                </div>
            </div>

            <div class="category" onclick="showCategory(2)" id="cat2">
                <div class="category-icon" id="icon2">üìÑ</div>
                <div class="category-info">
                    <h3>3. Documenti</h3>
                    <p>Bollette, contratti, garanzie, documenti vari</p>
                </div>
            </div>

            <div class="category" onclick="showCategory(3)" id="cat3">
                <div class="category-icon" id="icon3">üéÅ</div>
                <div class="category-info">
                    <h3>4. Komono (Oggetti vari)</h3>
                    <p>CD, cavi, oggetti elettronici, cosmetici, decorazioni</p>
                </div>
            </div>

            <div class="category" onclick="showCategory(4)" id="cat4">
                <div class="category-icon" id="icon4">üì∏</div>
                <div class="category-info">
                    <h3>5. Oggetti sentimentali</h3>
                    <p>Foto, lettere, ricordi - SEMPRE per ultimo!</p>
                </div>
            </div>
        </div>

        <div id="categoryDetail" class="detail hidden">
            <div class="detail-header">
                <div class="category-icon" id="detailIcon">üì¶</div>
                <div>
                    <h2 id="detailTitle"></h2>
                    <p id="detailDescription"></p>
                </div>
            </div>

            <div class="joy-box">
                <h3>‚ù§Ô∏è Domanda magica</h3>
                <p class="joy-question">"Questo oggetto accende la gioia nel mio cuore?"</p>
            </div>

            <div class="photo-section">
                <h3>üì∏ Foto opzionali</h3>
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">Documenta il tuo progresso!</p>
                
                <div>
                    <div class="photo-upload" onclick="uploadPhoto('before')" id="beforeUpload">
                        <p>üì∑ Foto PRIMA</p>
                        <p style="font-size: 0.8rem; color: #666;">Clicca per aggiungere</p>
                    </div>
                    
                    <div class="photo-upload" onclick="uploadPhoto('after')" id="afterUpload">
                        <p>üì∑ Foto DOPO</p>
                        <p style="font-size: 0.8rem; color: #666;">Clicca per aggiungere</p>
                    </div>
                </div>
                
                <div id="photoPreview"></div>
                <div id="screenshotPrompt" class="screenshot-prompt hidden">
                    üì∏ Fai uno screenshot per immortalare questo momento! üì∏
                </div>
            </div>

            <div class="tips">
                <h3>Consigli per questa categoria:</h3>
                <div id="tipsList"></div>
            </div>

            <div class="process">
                <h3>Il processo:</h3>
                <div class="process-step">
                    <span class="step-number">1</span>
                    Raccogli TUTTO da questa categoria in un posto
                </div>
                <div class="process-step">
                    <span class="step-number">2</span>
                    Tocca ogni oggetto con le mani
                </div>
                <div class="process-step">
                    <span class="step-number">3</span>
                    Chiedi: "Mi accende la gioia?"
                </div>
                <div class="process-step">
                    <span class="step-number">4</span>
                    Ringrazia gli oggetti che lasci andare
                </div>
            </div>

            <div class="buttons">
                <button class="btn btn-secondary" onclick="goBack()">Torna indietro</button>
                <button class="btn btn-primary" onclick="completeCategory()">‚úì Categoria completata!</button>
            </div>

            <div class="reward-section hidden" id="rewardSection">
                <div class="reward-quote">
                    <p id="rewardText">Ottimo lavoro! ‚ú®</p>
                    <p style="margin-top: 10px; opacity: 0.9;">üéâ Ben fatto! üéâ</p>
                </div>
                <button class="big-complete-button" id="bigButton" onclick="dissolveButton()">
                    <div>
                        <p>üéâ HAI COMPLETATO LA CATEGORIA! üéâ</p>
                        <p style="font-size: 1rem; margin-top: 10px; opacity: 0.9;">Clicca per vedere le congratulazioni!</p>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <script>
        var categories = [
            {
                name: "Vestiti",
                icon: "üëï",
                desc: "Raccogli TUTTI i vestiti da ogni stanza e mettili in un posto",
                tips: ["Tieni in mano ogni capo", "Chiedi: Mi accende la gioia?", "Piega con il metodo KonMari"]
            },
            {
                name: "Libri", 
                icon: "üìö",
                desc: "Raduna tutti i libri, riviste, manuali dalla casa",
                tips: ["Tieni solo i libri che ami davvero", "I libri da leggere un giorno spesso non si leggono mai", "Dona quelli che non ti servono pi√π"]
            },
            {
                name: "Documenti",
                icon: "üìÑ", 
                desc: "Bollette, contratti, garanzie, documenti vari",
                tips: ["La regola: butta quasi tutto", "Tieni solo documenti necessari", "Digitalizza quando possibile"]
            },
            {
                name: "Komono (Oggetti vari)",
                icon: "üéÅ",
                desc: "CD, cavi, oggetti elettronici, cosmetici, decorazioni", 
                tips: ["Categoria pi√π difficile", "Raggruppa per tipo", "Elimina i doppioni"]
            },
            {
                name: "Oggetti sentimentali",
                icon: "üì∏",
                desc: "Foto, lettere, ricordi - SEMPRE per ultimo!",
                tips: ["La categoria pi√π importante", "Prenditi tempo", "Conserva solo ci√≤ che ti rende felice"]
            }
        ];

        var quotes = [
            "La vita inizia davvero solo dopo aver messo in ordine.",
            "Tieni solo le cose che accendono la gioia nel tuo cuore.",
            "Ringrazia gli oggetti per il servizio reso prima di lasciarli andare.",
            "Il vero scopo del riordino non √® solo pulire, ma vivere nel modo che ti rende pi√π felice.",
            "Quando la tua stanza √® in ordine, anche la tua vita lo sar√†.",
            "Il riordino √® un dialogo con se stessi.", 
            "Essere ordinati significa essere gentili con il futuro s√©.",
            "La tua casa dovrebbe essere un luogo che ti sostiene e ti ispira."
        ];

        var rewardQuotes = [
            "Fantastico! Hai liberato spazio! ‚ú®",
            "Ogni oggetto che lasci andare ti rende pi√π libero! üïäÔ∏è",
            "Bravissimo! Stai creando uno spazio che riflette chi sei! üåü",
            "Ottimo lavoro! Hai fatto un passo importante! üåà",
            "Meraviglioso! La tua casa sta diventando un santuario! üè°",
            "Complimenti! Hai allenato la tua capacit√† di scegliere! üí™"
        ];

        var completed = [];
        var currentCat = -1;
        var mode = 'rigid';

        function start() {
            loadProgress();
            var randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            var quoteText = document.getElementById("quoteText");
            if (quoteText) quoteText.textContent = randomQuote;
            updateProgress();
            updateCategories();
            setMode(mode);
        }

        function setMode(newMode) {
            mode = newMode;
            var rigidBtn = document.getElementById("rigidBtn");
            var freeBtn = document.getElementById("freeBtn");
            var modeDesc = document.getElementById("modeDesc");
            var warningText = document.getElementById("warningText");
            
            if (rigidBtn && freeBtn && modeDesc && warningText) {
                if (mode === 'rigid') {
                    rigidBtn.classList.add("active");
                    freeBtn.classList.remove("active");
                    modeDesc.textContent = "Segui l'ordine originale di Marie Kondo";
                    warningText.textContent = "‚ö†Ô∏è Importante: completa una categoria alla volta, nell'ordine giusto!";
                } else {
                    freeBtn.classList.add("active");
                    rigidBtn.classList.remove("active");
                    modeDesc.textContent = "Scegli l'ordine che preferisci (sentimentali sempre per ultimo)";
                    warningText.textContent = "üí° Puoi scegliere l'ordine, ma ricorda: gli oggetti sentimentali vanno sempre per ultimi!";
                }
            }
            updateCategories();
            saveProgress();
        }

        function loadProgress() {
            var saved = localStorage.getItem('konmari-progress');
            if (saved) {
                var data = JSON.parse(saved);
                completed = data.completed || [];
                mode = data.mode || 'rigid';
            }
        }

        function saveProgress() {
            var data = { completed: completed, mode: mode };
            localStorage.setItem('konmari-progress', JSON.stringify(data));
        }

        function hideQuote() {
            var quote = document.getElementById("quote");
            if (quote) quote.style.display = "none";
        }

        function updateCategories() {
            for (var i = 0; i < 5; i++) {
                var categoryDiv = document.getElementById("cat" + i);
                var icon = document.getElementById("icon" + i);
                
                if (!categoryDiv || !icon) continue;
                
                var isCompleted = completed.includes(i);
                var canClick = false;
                
                if (mode === 'rigid') {
                    canClick = (i === completed.length);
                } else {
                    if (i === 4) {
                        canClick = (completed.length >= 4 && !isCompleted);
                    } else {
                        canClick = !isCompleted;
                    }
                }
                
                if (isCompleted) {
                    categoryDiv.className = "category completed";
                    icon.textContent = "‚úì";
                } else if (canClick) {
                    categoryDiv.className = "category";
                    icon.textContent = categories[i].icon;
                } else {
                    categoryDiv.className = "category locked";
                    icon.textContent = categories[i].icon;
                }
            }
        }

        function showCategory(index) {
            var canShow = false;
            
            if (mode === 'rigid') {
                canShow = (index === completed.length);
            } else {
                if (index === 4) {
                    canShow = (completed.length >= 4);
                } else {
                    canShow = !completed.includes(index);
                }
            }
            
            if (!canShow) return;
            
            currentCat = index;
            var cat = categories[index];
            
            var categoryList = document.getElementById("categoryList");
            var categoryDetail = document.getElementById("categoryDetail");
            
            if (categoryList) categoryList.classList.add("hidden");
            if (categoryDetail) categoryDetail.classList.remove("hidden");
            
            var detailIcon = document.getElementById("detailIcon");
            var detailTitle = document.getElementById("detailTitle");
            var detailDesc = document.getElementById("detailDescription");
            
            if (detailIcon) detailIcon.textContent = cat.icon;
            if (detailTitle) detailTitle.textContent = cat.name;
            if (detailDesc) detailDesc.textContent = cat.desc;
            
            var tipsList = document.getElementById("tipsList");
            if (tipsList) {
                tipsList.innerHTML = "";
                for (var i = 0; i < cat.tips.length; i++) {
                    var tipDiv = document.createElement("div");
                    tipDiv.className = "tip";
                    tipDiv.innerHTML = '<span class="tip-bullet"></span>' + cat.tips[i];
                    tipsList.appendChild(tipDiv);
                }
            }
            
            var rewardSection = document.getElementById("rewardSection");
            if (rewardSection) {
                rewardSection.classList.add("hidden");
            }
            
            var bigButton = document.getElementById("bigButton");
            if (bigButton) bigButton.classList.remove("dissolve");
            
            loadPhotos(index);
        }

        function goBack() {
            currentCat = -1;
            var categoryDetail = document.getElementById("categoryDetail");
            var categoriesList = document.getElementById("categoryList");
            
            if (categoryDetail) categoryDetail.classList.add("hidden");
            if (categoriesList) categoriesList.classList.remove("hidden");
        }

        function completeCategory() {
            if (currentCat >= 0) {
                var alreadyCompleted = completed.includes(currentCat);
                if (alreadyCompleted) return;
                
                var randomReward = rewardQuotes[Math.floor(Math.random() * rewardQuotes.length)];
                var rewardText = document.getElementById("rewardText");
                if (rewardText) rewardText.textContent = randomReward;
                
                var rewardSection = document.getElementById("rewardSection");
                if (rewardSection) {
                    rewardSection.classList.remove("hidden");
                }
            }
        }

        function dissolveButton() {
            if (currentCat >= 0) {
                var alreadyCompleted = completed.includes(currentCat);
                if (alreadyCompleted) return;
                
                completed.push(currentCat);
                updateCategories();
                updateProgress();
                saveProgress();
                
                var bigButton = document.getElementById("bigButton");
                if (bigButton) {
                    bigButton.classList.add("dissolve");
                }
                
                setTimeout(function() {
                    goBack();
                }, 10000);
            }
        }

        function updateProgress() {
            var percent = (completed.length / 5) * 100;
            var progressBar = document.getElementById("progress");
            var progressText = document.getElementById("progressText");
            
            if (progressBar) progressBar.style.width = percent + "%";
            if (progressText) progressText.textContent = completed.length + "/5 categorie completate";
        }

        function loadPhotos(categoryIndex) {
            var beforeKey = 'photo-before-' + categoryIndex;
            var afterKey = 'photo-after-' + categoryIndex;
            var beforePhoto = localStorage.getItem(beforeKey);
            var afterPhoto = localStorage.getItem(afterKey);
            
            var preview = document.getElementById("photoPreview");
            if (!preview) return;
            
            preview.innerHTML = "";
            
            if (beforePhoto) {
                var beforeDiv = document.createElement("div");
                beforeDiv.innerHTML = '<p><strong>Prima:</strong></p><img src="' + beforePhoto + '" class="photo-preview">';
                preview.appendChild(beforeDiv);
            }
            
            if (afterPhoto) {
                var afterDiv = document.createElement("div");
                afterDiv.innerHTML = '<p><strong>Dopo:</strong></p><img src="' + afterPhoto + '" class="photo-preview">';
                preview.appendChild(afterDiv);
            }
            
            var screenshotPrompt = document.getElementById("screenshotPrompt");
            if (screenshotPrompt) {
                if (beforePhoto && afterPhoto) {
                    screenshotPrompt.classList.remove("hidden");
                } else {
                    screenshotPrompt.classList.add("hidden");
                }
            }
        }

        function uploadPhoto(type) {
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                var file = e.target.files[0];
                if (!file) return;
                
                var reader = new FileReader();
                reader.onload = function(event) {
                    var key = 'photo-' + type + '-' + currentCat;
                    localStorage.setItem(key, event.target.result);
                    loadPhotos(currentCat);
                };
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        start();
    </script>
</body>
</html>
